## 公式执行和事件队列优化

![[公式执行和事件队列优化.png]]

上图可见，新增的类和删除的类，需要比对两个版本的公式执行和时间队列，优化点到底在哪里


## 修复异常问题

优化后带来的异常问题，进行了修复工作 

1. 修复登录表单重复调用问题  
2. 修改Slider值变化连续改为手指抬起触发值变化事件  
3. 修复在10.0系统上报错
4. 修复因contentview设置大小不及时导致 Gallery设置DisplayRatio属性显示异常  
5. 修复升级XCode导致的报错
6. 修复主界面报错卡死问题  
7. 修复HoverButton影响主界面异常  
8. 修复列表删除不存在行问题  
9. 上传图片异常
10. 修复字典测滑界面和Confirm界面转圈圈无法隐藏  
11. 修复列表删除不存在行问题  
12. 修复CountUp自适应滚动无效
13. 修复固定行加载数据异常
14. 修复ClearAllRow方法无效异常
15. 更新百度语音sdk的key
16. 修复SwitchButton点击事件异常
17. 文件名修改
18. 验证框修复不显示图片异常
19. 修复Container登出切换再登录显示异常
20. 修正登出以及切换url需清掉cookies缓存
21. 修复CountUp在TableView明细行不可见异常
22. 修复字典设置事件未在队列中执行
23. 验证登录属性只支持按钮和超链接 ，与安卓保持一致  
24. 修复重复游客登录异常  
25. 修复登录表单Meta对象被清空异常
26. 修复字典报错
27. 修复视图被移除时边框视图添加约束异常  
28. 修复声音循环播放无效
29. popupview修改无效方向参数默认值

由此可见，优化后带来的影响还是比较大的

## 后续思考

不需要考虑队列，随时随地读写数据，没有任何数据安全问题

1. 线程池如何控制队列的串行和并发
2. 主线程处理任务时，同时开启异步线程，并发执行任务
3. 异步线程，执行完任务，回到主线程，如何线程间通信
4. 线程对同一块资源读写，造成线程安全，需要加锁操作

## 内存问题

UploadAttachmentUtil 单例造成的内存问题，需要探讨