## 耗电如何优化？

1. 耗电主要来源于 cpu，gpu、网络、定位、图像 graphics
2. 针对 cpu，少用 timer，优化 io 操作，不要频繁写入小数据，一次性批量写入；数据量比较大，使用sqlite、coredata；读写大量重要数据，使用dispatch_io，系统会优化磁盘访问
3. 针对 gpu，避免短时间大量图片显示，避免图片纹理尺寸超过gpu处理的阈值
4. 针对网络，如果多次请求结果一致，使用缓存，比如图片请求；视频上传下载，使用断点续传和分片加载；网络不可用时，不要继续执行网络请求，使用网络监听处理；设置合适超时时间，取消超时的网络操作；
5. 针对定位，需要结合业务，只需要快速确定用户位置，定位完成后，自动让定位硬件断电；不是地图行车模块，不要实时更新位置，定位完成即可关掉定位服务；非必要不要使用精确度最高的定位设置，降低定位精度；后台定位时，设置用户不移动时系统自动暂停位置更新；
6. 针对硬件检测，若干功能模块切换横竖屏使用motion 陀螺仪硬件检测动作事件的，改成 orientation 对横竖屏进行支持，避免这些硬件的使用

## 优化前后的情况？

1. 通过 IOKit framework 来获取硬件信息，进而获取到电量消耗信息
2. 耗电情况通过优化前后每小时消耗多少电量进行比对
3. 优化后耗电量减少了 10%

## 耗电如何检测？

1. 通过遍历所有线程，去查看是哪个线程的 CPU 使用百分比过高了。
2. 如果某个线程的 CPU 使用率长时间都比较高的话，比如超过了 90%，就能够推断出它是有问题的。
3. 这时，将其方法堆栈记录下来，你就可以知道到底是哪段代码让你 App 的电量消耗多了
4. cpu使用量确实是耗电的重大原因。不合理的动画可能导致cpu暴涨，电量损耗巨大